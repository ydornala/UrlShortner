{"version":3,"sources":["api/Code/code.controller.js"],"names":["index","req","res","user","Link","findOneAndUpdate","urlCode","params","code","$inc","$addToSet","clickedBy","_id","new","then","linkFound","redirect","longUrl","catch","err","status","json","error","console"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEO,SAASA,KAAT,CAAeC,GAAf,EAAoBC,GAApB,EAAyB;AAC5B,MAAMC,IAAI,GAAGF,GAAG,CAACE,IAAjB;;AAEA,MAAI;AACA,WAAOC,cAAKC,gBAAL,CAAsB;AAACC,MAAAA,OAAO,EAAEL,GAAG,CAACM,MAAJ,CAAWC;AAArB,KAAtB,EAAkD;AAACC,MAAAA,IAAI,EAAE;AAAC,kBAAU;AAAX,OAAP;AAAsBC,MAAAA,SAAS,EAAE;AAACC,QAAAA,SAAS,EAAER,IAAI,CAACS;AAAjB;AAAjC,KAAlD,EAA2G;AAACC,MAAAA,GAAG,EAAE;AAAN,KAA3G,EACFC,IADE,CACGC,SAAS,IAAI;AACf,aAAOb,GAAG,CAACc,QAAJ,CAAaD,SAAS,CAACE,OAAvB,CAAP;AACH,KAHE,EAIFC,KAJE,CAIIC,GAAG,IAAI;AACV,aAAOjB,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,cAArB,CAAP;AACH,KANE,CAAP;AAOH,GARD,CAQE,OAAOC,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACApB,IAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,cAArB;AACH;AACJ","sourcesContent":["import Link from '../Links/link.model';\nimport _ from 'lodash';\n\nexport function index(req, res) {\n    const user = req.user;\n\n    try {\n        return Link.findOneAndUpdate({urlCode: req.params.code}, {$inc: {'clicks': 1}, $addToSet: {clickedBy: user._id}}, {new: true})\n            .then(linkFound => {                               \n                return res.redirect(linkFound.longUrl);\n            })\n            .catch(err => {\n                return res.status(404).json('No url found');\n            })\n    } catch (error) {\n        console.error(error);\n        res.status(500).json('Server error');\n    }\n}"],"file":"code.controller.js"}